{"timestamp": "2025-10-15T10:46:51.033254", "level": "ERROR", "logger": "customer_bot.error", "message": "Error occurred: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('02a703a0-ad1b-4920-8206-62c59b89c12b', '2025-10-15 10:46:50.831474', '2025-10-15 10:46:50.831474', '2025-10-16 10:46:50.815582', 1, 0, '2025-10-15 10:46:50.831474')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "logger", "function": "log_error", "line": 135, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlite3.OperationalError: table chat_sessions has no column named expires_at\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 48, in get_or_create_session\n    await self.db.flush()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 800, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('02a703a0-ad1b-4920-8206-62c59b89c12b', '2025-10-15 10:46:50.831474', '2025-10-15 10:46:50.831474', '2025-10-16 10:46:50.815582', 1, 0, '2025-10-15 10:46:50.831474')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "session_id": null, "response_time": 6.195446014404297}
{"timestamp": "2025-10-15T10:46:51.085255", "level": "ERROR", "logger": "customer_bot.middleware", "message": "Unexpected error: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('02a703a0-ad1b-4920-8206-62c59b89c12b', '2025-10-15 10:46:50.831474', '2025-10-15 10:46:50.831474', '2025-10-16 10:46:50.815582', 1, 0, '2025-10-15 10:46:50.831474')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "error_handler", "function": "dispatch", "line": 81, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlite3.OperationalError: table chat_sessions has no column named expires_at\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\middleware\\error_handler.py\", line 27, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 123, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 109, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 387, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 288, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 48, in get_or_create_session\n    await self.db.flush()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 800, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('02a703a0-ad1b-4920-8206-62c59b89c12b', '2025-10-15 10:46:50.831474', '2025-10-15 10:46:50.831474', '2025-10-16 10:46:50.815582', 1, 0, '2025-10-15 10:46:50.831474')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "response_time": 6.3992698192596436}
{"timestamp": "2025-10-15T10:47:53.079973", "level": "ERROR", "logger": "customer_bot.error", "message": "Error occurred: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('50693a44-3212-4346-b3fb-81cb90cd61aa', '2025-10-15 10:47:53.059121', '2025-10-15 10:47:53.059121', '2025-10-16 10:47:53.051131', 1, 0, '2025-10-15 10:47:53.059121')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "logger", "function": "log_error", "line": 135, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlite3.OperationalError: table chat_sessions has no column named expires_at\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 48, in get_or_create_session\n    await self.db.flush()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 800, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('50693a44-3212-4346-b3fb-81cb90cd61aa', '2025-10-15 10:47:53.059121', '2025-10-15 10:47:53.059121', '2025-10-16 10:47:53.051131', 1, 0, '2025-10-15 10:47:53.059121')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "session_id": null, "response_time": 4.129260063171387}
{"timestamp": "2025-10-15T10:47:53.098966", "level": "ERROR", "logger": "customer_bot.middleware", "message": "Unexpected error: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('50693a44-3212-4346-b3fb-81cb90cd61aa', '2025-10-15 10:47:53.059121', '2025-10-15 10:47:53.059121', '2025-10-16 10:47:53.051131', 1, 0, '2025-10-15 10:47:53.059121')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "module": "error_handler", "function": "dispatch", "line": 81, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlite3.OperationalError: table chat_sessions has no column named expires_at\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\middleware\\error_handler.py\", line 27, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 123, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 109, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 387, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 288, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 48, in get_or_create_session\n    await self.db.flush()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 800, in flush\n    await greenlet_spawn(self.sync_session.flush, objects=objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 203, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 1233, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1846, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1986, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1967, in _exec_single_context\n    self.dialect.do_execute(\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 147, in execute\n    self._adapt_connection._handle_exception(error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 298, in _handle_exception\n    raise error\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\sqlite\\aiosqlite.py\", line 129, in execute\n    self.await_(_cursor.execute(operation, parameters))\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 132, in await_only\n    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 196, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 48, in execute\n    await self._execute(self._cursor.execute, sql, parameters)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\cursor.py\", line 40, in _execute\n    return await self._conn._execute(fn, *args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 132, in _execute\n    return await future\n           ^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\aiosqlite\\core.py\", line 115, in run\n    result = function()\n             ^^^^^^^^^^\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) table chat_sessions has no column named expires_at\n[SQL: INSERT INTO chat_sessions (id, created_at, updated_at, expires_at, is_active, message_count, last_activity) VALUES (?, ?, ?, ?, ?, ?, ?)]\n[parameters: ('50693a44-3212-4346-b3fb-81cb90cd61aa', '2025-10-15 10:47:53.059121', '2025-10-15 10:47:53.059121', '2025-10-16 10:47:53.051131', 1, 0, '2025-10-15 10:47:53.059121')]\n(Background on this error at: https://sqlalche.me/e/20/e3q8)", "response_time": 4.153312683105469}
{"timestamp": "2025-10-15T10:49:22.545896", "level": "ERROR", "logger": "customer_bot.error", "message": "Error occurred: 'Logger' object has no attribute 'info'", "module": "logger", "function": "log_error", "line": 135, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 50, in get_or_create_session\n    logger.info(f\"Created new session: {session.id}\")\n    ^^^^^^^^^^^\nAttributeError: 'Logger' object has no attribute 'info'", "session_id": null, "response_time": 6.885662078857422}
{"timestamp": "2025-10-15T10:49:22.575741", "level": "ERROR", "logger": "customer_bot.middleware", "message": "Unexpected error: 'Logger' object has no attribute 'info'", "module": "error_handler", "function": "dispatch", "line": 81, "exception": "Traceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 151, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 126, in receive\n    raise EndOfStream from None\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\middleware\\error_handler.py\", line 27, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 159, in call_next\n    raise app_exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 123, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 109, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 387, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 288, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\api\\chat.py\", line 23, in chat\n    session = await service.get_or_create_session(req.session_id)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"E:\\Projects\\Customer_Bot\\backend\\app\\services\\session_manager.py\", line 50, in get_or_create_session\n    logger.info(f\"Created new session: {session.id}\")\n    ^^^^^^^^^^^\nAttributeError: 'Logger' object has no attribute 'info'", "response_time": 6.89361834526062}
